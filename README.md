# 梧桐树下前端静态站点运维说明

本项目为基于 Vite 的静态前端站点，主要提供官网页面和 App 下载入口。

---

## 一、下载链接修改位置

### 下载链接逻辑配置

- 文件路径：`/main.js`
- 作用：根据访问设备类型（苹果 / 安卓）跳转到对应应用市场
- 查找方式：搜索注释 `// Download Logic` 即可定位到相关代码块

该代码块中有两个常量需要关注：

- `appleUrl`：iOS / iPadOS 端 App Store 地址
- `androidUrl`：Android 端应用市场地址

#### 修改步骤

1. 使用编辑器打开项目根目录下的 `main.js`
2. 找到 `// Download Logic` 注释下方的逻辑代码
3. 将其中的：
   - `appleUrl` 修改为新的 iOS 下载地址
   - `androidUrl` 修改为新的 Android 下载地址
4. 保存文件后，按下文说明重新构建并发布静态资源

#### 注意事项

- 请确保填写的 URL 为 **完整可访问的 HTTPS 地址**（推荐 `https://` 开头）
- 如果上线环境有缓存（CDN / 反向代理等），发布后注意 **刷新缓存**，以免用户仍然访问旧链接

---

## 二、本地与服务器构建/打包命令

项目使用 Vite 构建，相关配置文件：`/vite.config.js`

### 1. 运行环境要求

- Node.js：`>= 22.12.0`（参考 `package.json` 中 `engines.node`）
- 包管理工具：推荐使用 **npm**（也可根据团队规范使用 pnpm/yarn，但本说明以 npm 为例）

首次在机器上操作本项目时，请先安装依赖：

```bash
npm install
```

### 2. 本地开发 / 联调（可选）

如需本地起一个开发服务用于问题排查或联调，可执行：

```bash
npm run dev
```

- 默认会启动 Vite 开发服务器（端口通常为 `5173`，具体以终端输出为准）
- 本地访问地址示例：`http://localhost:5173/`

### 3. 构建 / 打包（用于正式发布）

用于生成可部署到生产环境的静态文件：

```bash
npm run build
```

- 构建成功后，会生成 `dist/` 目录
- `dist/` 目录下的内容即为 **需要发布到 Web 服务器 / CDN 的静态资源**

### 4. 生产预览（类生产环境本地验证）

在发布前，可在本地以“接近生产环境”的方式预览打包结果：

```bash
npm run build   # 如尚未构建，请先执行
npm run preview
```

- Vite 会在本地启动一个静态文件预览服务（端口通常为 `4173`）
- 可访问类似 `http://localhost:4173/` 进行最终验证

---

## 三、发布到服务器的典型流程（参考）

> 以下为通用静态站点发布流程，具体以公司现有发布系统 / CI 流程为准。

1. **拉取最新代码** 到构建机
2. 执行依赖安装（如首次或依赖有变更）：
   ```bash
   npm install
   ```
3. **修改下载链接（如有变更）**：
   - 按“下载链接逻辑配置”一节修改 `main.js` 中的 `appleUrl` / `androidUrl`
4. 执行构建打包：
   ```bash
   npm run build
   ```
5. 将生成的 `dist/` 目录内容：
   - 同步 / 上传到 Web 服务器对应的静态资源目录
   - 或上传到 CDN / 对象存储（视现有架构而定）
6. 如有 Nginx 等反向代理：
   - 确保根目录指向 `dist/` 中的入口 `index.html`
7. 如使用缓存（CDN、本地缓存等）：
   - 发布完成后执行 **刷新缓存 / 失效处理**，确保新下载链接立即生效

---

## 四、常见问题排查

- **访问页面正常，但点击“下载”无反应或跳转错误**
  - 检查 `main.js` 是否已正确修改并重新构建
  - 确认浏览器未命中旧版本缓存（可尝试无痕窗口或强制刷新）
  - 检查 CDN / 代理缓存是否已刷新

- **构建失败**
  - 确认 Node.js 版本满足 `>= 22.12.0`
  - 如近期升级了 Node 或依赖，可尝试删除 `node_modules` 并重新执行 `npm install`
